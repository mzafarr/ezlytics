# Ralphy Progress Log


[2026-01-20T15:42:15.838Z] Completed US-016: added revenue split chart + refund totals on site dashboard; lint passed.
[2026-01-20T16:26:01.457Z] Completed US-017: encrypt sensitive metadata fields at ingest via sanitizeMetadataRecord; lint passed.
2026-01-21T00:49:20Z - Completed US-018: displayed metadata in visitor timeline with ordering/grouping and lint passed.

[2026-01-21T00:54:33Z] Completed US-019: ordered visitor timeline by timestamp samples; lint passed.
[2026-01-21T01:14:23.877Z] Completed US-001: added raw_event timestamp/session columns + indexes + migration; lint passed.
[2026-01-21T01:33:01.199Z] Completed US-002: validated ts/session_id ingestion and allowlisted fields; lint passed (build failed: missing REVENUE_PROVIDER_KEY_SECRET).

[2026-01-21T01:42:17.568Z] Completed US-003: added ts + session_id to tracking events with 30m session rotation; lint passed.

[2026-01-21T01:52:03.828Z] Marked US-001 as completed in tasks-2.yaml; lint passed (build failed: missing REVENUE_PROVIDER_KEY_SECRET).
[2026-01-21T01:59:11.007Z] Completed US-004: computed session metrics (bounce + avg duration) in dashboard hook + KPI wiring; lint passed.
[2026-01-21T02:20:34.226Z] Completed US-005: stored session metrics in rollups with migration and ingest rollup updates; lint passed.

[2026-01-21T03:21:49.518Z] Completed US-006: added bounce rate + avg session KPI cards to overview; lint passed.
- [✓] 2026-01-21 08:48 - Show bounce rate and session time in Overview KPIs
- [✓] 2026-01-21 09:08 - Show bounce rate and session time in Overview KPIs
- [✓] 2026-01-21 09:29 - Compute Visitors Now (last 5 minutes)
- [✓] 2026-01-21 09:49 - Display Visitors Now in Overview KPIs
- [✓] 2026-01-21 10:08 - Add geo fields to events schema
- [✓] 2026-01-21 10:40 - Resolve geo data on ingestion
- [✓] 2026-01-21 11:12 - Include geo dimensions in rollups
- [✓] 2026-01-21 11:19 - Replace geo placeholders with map and region/city 
- [✓] 2026-01-21 13:33 - Replace geo placeholders with map and region/city 
- [✓] 2026-01-21 13:38 - Replace geo placeholders with map and region/city 
- [✓] 2026-01-21 14:02 - Replace geo placeholders with map and region/city 
- [✓] 2026-01-21 14:05 - Replace geo placeholders with map and region/city 
- [✓] 2026-01-22 15:29 - If both `sessionId` and `session_id` are present and differ, return 400 with a clear error field.
- [✓] 2026-01-22 15:40 - If only one is present or both match, continue ingest normally.
- [✓] 2026-01-22 15:47 - If only one is present or both match, continue ingest normally.
- [✓] 2026-01-22 15:58 - Missing User-Agent does not automatically set `bot=true`.
- [✓] 2026-01-22 16:36 - `bot` flag is only accepted for privileged/server-side requests (e.g., server key or server-only endpoint); untrusted use is rejected or ignored.
- [✓] 2026-01-22 17:09 - Rollups include UA-less events unless flagged as bot via a privileged path.
